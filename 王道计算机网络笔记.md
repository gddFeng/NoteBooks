# 第1章——计算机网络体系结构

## 1.1 计算机网络概述

### 1. 概念、组成、功能和分类

计算机网络：是一个将分散的、具有独立功能的**计算机系统**，通过**通信设备**与**线路**连接起来，由功能完善的**软件**实现**资源共享**和**信息传递**的系统。

* 计算机网络是**互连**的、**自治**的计算机集合。
  * 互连指互联互通 *通信链路*
  * 无主从关系
  
* 计算机网络的功能
  1.  数据通信（连通性）
  2.  资源共享（硬件、软件、数据）
  3.  分布式处理
  4.  提高可靠性
  5.  负载均衡
  6.  ……

* 计算机网络的组成
  1. 组成部分
     * 硬件
     * 软件
     * 协议
  2. 工作方式
     * 边缘系统
       * C/S模式
       * P2P模式
     * 核心部分
       * 为边缘部分服务
  3.  功能组成
      *   通信子网
          *   实现**数据通信**
          *   各种传输介质、通信设备、相应的网络协议组成
      *   资源子网 
          *   实现**资源共享**/数据处理
          *   实现资源共享功能的设备和软件的集合
  
* 计算机网络的分类
  1.  按分布范围分
      * 广域网WAN
        * 交换技术
      * 城域网MAN
      * 局域网WAN
        * 广播技术
      * 个人区域网PAN
  2.  按使用者分
      *   公用网
          *   三大运营商
      *   专用网
          *   政府、军队
  3.  按交换技术分
      *   电路交换
      *   报文交换
      *   分组交换
  4.  按拓补结构分
      *   总线型
      *   星型
      *   环型
      *   网状型
          *   常用于广域网
  5. 按传输技术分
     * 广播式网络
       * 共享公共通信信道
     * 点对点网络
       * 使用**分组存储转发**和**路由选择**机制

### 2. 计算机网络标准化工作及相关组织

#### 标准化工作

要实现不同厂商的软硬件之间相互通信，必须遵从统一的标准。

* 标准的分类
  * 法定标准
    * 由权威机构制定的正式的、合法的标准
    * 如：OSI
  * 事实标准
    * 某些公司的产品在竞争中占据了主流，时间长了，这些产品中的协议和技术就成了标准
    * 如：TCP/IP

#### RFC及其发展为因特网标准的四个阶段

* RFC(Request For Comments)——因特网标准的形式
  1.  因特网草案(Internet Draft) 这个阶段还不是RFC文档
  2.  建议标准(Proposed Standard) 从这个阶段开始称为RFC文档
  3.  草案标准(Draft Standard) IETF、IAB审核，2011年取消了该阶段
  4.  成为因特网标准(Internet Standard)

#### 标准化工作的相关组织

* ISO 国际标准化组织
  * 案例：OSI参考模型
  * HDLC协议
* ITU 国际电信联盟
  * 制定通信规则
* IEEE 国际电气电子工程师协会
  * 学术机构
  * IEEE802系列标准
  * 5G
* IETF Internet工程任务组
  * 负责因特网相关标准的制定
  * RFC XXXX

### 3.性能指标之速率、带宽、吞吐量

#### 速率

速率即**数据率**或称**数据传输率**或**比特率**。

连接在计算机网络上的**主机**在数字信道上传送数据**位数的速率**。

* 速率
  * kb/s
  * Mb/s
  * Gb/s
  * Tb/s
  * 倍数是10的3次方
* 存储容量
  * 1 Byte(字节) = 8 bit(比特)
  * 1KB = 1024 B
  * 1MB = 1024 KB
  * 1GB = 1024 MB
  * 1TB = 1024 GB
  * 倍数为1024倍

#### 带宽

1. “带宽”原本指某个信号具有的频带宽度，即最高频率与最低频率之差，单位是盒子(Hz)。
2. 计算机网络中，带宽用来表示传输数据时的最高数据率
3. 带宽越高，在单位时间内发送的数据信号密度越大

#### 吞吐量

表示在**单位时间**内通过**某个网络(或信道、接口)**的数据量。

吞吐量受网络的带宽或网络的额定速率的限制，服务器性能以及网线等原因都会影响吞吐量。

### 4. 时延、时延带宽积、RTT和利用率

#### 时延

指数据(报文/分组/比特流)从网络(或链路)的一段传送到另一端所需的时间。也叫`延迟`或`迟延`。单位是s。

* 时延
  1.  发送时延(传输时延)
      *   从发送分组的第一个比特算起，到该分组的最后一个比特发送完毕所需的时间
      *   发送时延 = 数据长度/信道带宽
      *   **高速链路**是提高发送速率，减小了发送时延！
  2.  传播时延
      *   取决于电磁波传播速率和链路长度
      *   固体传播速率比在真空中要慢点
      *   传播时延 = 信道长度/电磁波在信道上的传播率
  3.  排队时延
      *   等待输出\输入链路可用
      *   其实就是在路由器缓存区等待转发的时间
  4.  处理实验
      *   路由器进行校验以及通过路由表查询路径

#### 时延带宽积

有多少数据在链路中：
`时延带宽积 = 传播时延 X 带宽`
时延带宽积又称为以**比特为单位的链路长度**。

#### 往返时延RTT(roud trip time)

从发送方发送数据开始，到发送方收到接收方的确认，总经历的时延。

RTT越大，在收到确认之前，可以发送的数据越多。

* RTT包括
  *   往返传播时延 = 传播时延 * 2
      *   主要时间
  *   末端处理时间
      *   通常忽略

#### 利用率

* 利用率
  * 信道利用率
    * `有数据通过时间\(有+无)数据通过时间`
  * 网络利用率
    * 信道利用率加权平均值

利用率趋近于1时，时延呈指数级增长，从而导致速率被降低

## 1.2 计算机网络体系结构与参考模型

### 1. 分层结构、协议、接口、服务

#### 为什么要分层？

* 发送文件前要完成的工作：
  1. 发起通信的计算机必须将数据通信的通路进行**激活**。
  2. 要告诉网络如何识别目的主机
  3. 发起通信的计算机要查明目的主机是否开机，并且与网络连接正常
  4. 发起通信的计算机要弄清楚，对方计算机中文件管理程序是否已经做好准备工作
  5. 确保差错和以外可以解决

#### 怎么分层？

* 分层的基本原则
  1.  各层之间相互**独立**，每层只实现一种相对独立的功能。
  2.  各层之间**界面自然清晰**，易于理解，相互交流尽可能少。
  3.  结构上可分割开。每层都采用**最合适的技术**来实现。
  4.  保持**下层**对**上层**的独立性，**上层单向使用下层提供的服务**。
  5.  整个分层结构应该能促进标准化工作。

#### 正式认识分层结构

* 正式认识分层结构
  1.  实体：第n层中的活动元素称为**n层实体**。同一层的实体叫做**对等实体**。
  2.  协议：为进行网络中的**对等实体**数据交换而建立的规则、标准或约定称为网络协议。【协议是水平的】
      * 语法：规定传输数据的格式
      * 语义：规定所要完成的功能
      * 同步：规定各种操作的顺序
  3. 接口(访问服务点SAP)：上层使用下层服务的入口。
  4. 服务：下层为相邻上层提供的功能调用。【垂直】

`PDU = PCI + SDU`
* SDU服务数据单元：为完成用户所要求的功能而应传送的数据
* PCI协议控制信息：控制协议操作的信息。
* PDU协议数据单元：对等层次之间传送的数据单位

#### 概念总结
* 网络体系结构是从**功能**上描述计算机网络结构。
* 计算机网络体系结构简称网络体系结构是**分层结构**
* 每层遵循某个/些**网络协议**以完成本层功能。
* **计算机网络体系结构**是计算机网络的**各层及其协议**的集合。
* 在n层在向n+1层提供服务时，此服务不仅包含第n层本身的功能，还包含由下层服务提供的功能。
* 仅仅在**相邻层间有接口**，且所提供服务的具体实现细节对上一层完全屏蔽。
* 体系结构是**抽象**的，而实现是指能运行的一些软件和硬件。

### 2. OSI参考模型

* 计算机网络分层结构
  * 7层OSI参考模型（法定标准）
  * 4层TCP/IP参考模型（事实标准）
  * 5层的体系结构（仅供学习）

#### ISO/OSI参考模型——怎么来的？

为了解决计算机网络复杂的大问题，按功能设计分层结构，目的是支持异构网络系统的互联互通。

#### ISO/OSI参考模型

7.  应用层
6.  表示层
5.  会话层
4.  传输层
3.  网络层
2.  数据链路层
1.  物理层

前四层端到端，后三层点到点

#### 应用层

所有能和用户交互产生网络流量的程序。

* 典型应用层服务：
  * 文件传输（FTP）
  * 电子邮件（SMTP）
  * 万维网（HTTP）

#### 表示层

用于处理在两个通信系统中交换信息的表示方式（语法和语义）

功能：
1.  数据格式变换
2.  数据加密解密
3.  数据压缩和恢复

#### 会话层

向表示层实体/用户进程提供**建立连接**并在连接上**有序**地**传输**数据。

这是会话，也是**建立同步(SYN)**.

功能：
1. 建立、管理、终止会话
2. 使用校验点可使会话在通信时效时从**校验点/同步点**继续恢复通信，实现数据同步。
   * 适用于传输大文件
   * 主要协议：ADSP、ASP

#### 传输层

负责主机中**两个进程**的通信，即**端到端**的通信。传输单位是报文段或用户数据报。

报文段就是数据切割后封装好形成的。

功能：
1. 可靠传输、不可靠传输
   * TCP
   * UDP
2. 差错控制
   * 校验
3. 流量控制
   * 控制发送速度，用来协调
4. 复用分用
   * 复用：多个应用层进程可同时使用下面运输层的服务。
   * 分用：运输层把收到的信息分别交付给上面应用层中相应的进程。

#### 网络层

主要任务是吧**分组**从源端传到目的端，为分组交换网上的不同主机提供通信服务。网络层传输单位是**数据报**。

功能：
1.  路由选择
   * 根据网络状况规划最佳路径
2.  流量控制
3.  差错控制
4.  拥塞控制
   * 若所有结点都来不及接收分组，而要丢弃大量分组的话，网络就处于**拥塞**状态。因此要采取一定措施，缓解这种拥塞。

主要协议：IP、IPX、ICMP、IGMP、ARP、RARP、OSPF

#### 数据链路层

主要任务是把网络层传下来的数据报**组装成帧**。

数据链路层/链路层的传输单位是**帧**。

功能：
1.  成帧(定义帧的开始和结束)
2.  差错控制  帧错+位错
   * 根据出错情况，决定是检错还是丢
3.  流量控制
   *  根据缓存情况确定，缓存快满了会被要求降速
4.  访问（接入）控制
   *  控制对共享信道的访问

主要协议：SDLC、HDLC、PPP、STP

#### 物理层

主要任务是在**物理媒体**上实现比特流的**透明传输**。
物理层传输单位是**比特**。

透明传输：指不管所传数据是什么样的比特组合，都应当能够在连路上传送。

功能：
1. 定义接口特性
2. 定义传输模式
   *  单工：只可以发送或接收
   *  半双工：可发送也可接收，但不能同时进行
   *  双工：可以同时发送和接收
3.  定义传输速率
4.  比特同步
5.  比特编码

主要协议：Rj45、802.3

### 3. TCP/IP参考模型和5层参考模型

TCP/IP参考模型是现有实践，后有的模型

TCP/IP参考模型：
4. 应用层
3. 传输层
2. 网际层
1. 网络接口层
   
TCP/IP协议栈：
4. HTTP|FTP|DNS
3. TCP|UDP
2. IP
1. Ethernet|ATM|Frame Relay

#### OSI和TCP/IP参考模型相同点

1. 都分层
2. 基于独立的协议栈概念
3. 可以实现异构网络互连

#### OSI模型与TCP/IP模型的不同点

1. OSI定义三点：服务、协议、接口
2. OSI先出现，参考模型先于协议发明，不偏向特定协议
3. TCP/IP设计之初就考虑到异构网互连问题，将IP作为重要层次。

* 网络层-IP协议
  * ISO/OSI参考模型
    * 无连接
    * 面向连接
  * TCP/IP模型
    * 无连接
* 传输层
  * ISO/OSI参考模型
    * 面向连接
  * TCP/IP模型
    * 无连接
    * 面向连接

面向连接：
1. 建立连接：发送建立连接请求。
2. 传输：擦混输数据
3. 释放连接：切断建立的连接。

无连接：
1. 直接传输数据

#### 5层参考模型

5. 网络层：支持各种网络应用 FTP、SMTP、HTTP
4. 传输层：进程-进程之间的数据传输 TCP、UDP
3. 网络成：源主机到目的主机的数据分组路由与转发 IP、ICMP、OSPE等
2. 数据链路层： 把网络层传下来的数据报组装成帧 Ethernet、PPP
1. 物理层：比特传输

# 第2章——物理层

## 2.1 通信基础

1. 通信基础
2. 两个公式 lim *重点*
3. 看图说话
4. 传输介质
5. 物理层设备
6. 
### 1. 物理层的基本概念

物理层解决如何在连接各种计算机的传输媒体上**传输数据比特流**，而不是指具体的差UN属媒体。

物理层主要任务：确定与传输媒体**接口**有关的一些特性，规格等

特性：
1. 机械特性：定义物理连接的特性，规定物理连接时所采用的规格、借口形状、引线数目、引脚数量和排列情况。
2. 电气特性：规定传输二进制位时，线路上信号的**电压范围**、阻抗匹配、传输**速率**和**距离**限制等。
3. 功能特性：指明某条线上出现的某一**电平表示何种意义**，就扣不见得信号线的用途。
4. 过程特性（过程特性）：定义各条物理线路的工作**规程和时序**关系。

### 2. 数据通信基础知识

#### 数据通信相关术语

通信的目的是**传送消息**。

数据：传送信息的实体。通常是有意义的符号序列。

信号：数据的电气/电磁的表现，是数据在传输过程中的**存在形式**。

* 数字信号：代表消息的参数取值是离散的。
* 模拟信号：代表消息的参数取值是连续的。

信源：产生和发送数据的源头。

信宿：接收数据的重点。

信道：信号的传输媒介。一般用来表示向某一个方向传送信息的介质，因此一条通信线路往往包含一条发送信道和一条接收信道。

* 传输信号
  * 模拟信道
  * 梳子信道
* 传输介质
  * 无线信道
  * 有线信道

#### 三种通信方式

1. 单工通信：只有一个方向的通信而没有反方向的交互，仅需要**一条**信道。
2. 半双工通信：通信的双方都可以发送或接收信息，但任何一方都不能同时发送和接收，需要**两条**信道。这两条信道都是既可以做发送方也可以做接收方。
3. 全双工通信：通信双方可以同时发送和接收信息，也需要**两条**信道。

#### 两种数据传输方式

* 串行传输
  * 单线程，单信道
  * 速度慢、费用低、适合远距离
* 并行传输
  * 多线程，多信道
  * 速度快、费用高、适合计算机内部传输
  * 打印机、扫描仪的插口就是**并口**（并行传输）

### 3. 码元、波特、速率、带宽

#### 码元

**码元**是指一个**固定时长**的**信号波形**(数字脉冲)，代表不同离散数值的基本波形，是数字通信中数字信号的计量单位，这个时长内的信号称为k进制码元，而该时长称为码元宽度。当码元的离散状态有M个时(M大于2)，此时码元为M进制码元。

**1码元可以携带多个比特的信息量**。例如，再使用二进制编码时，只有两种不同的码元，一种代表0状态，另一种代表1状态。

#### 速率、波特、带宽

速率也叫数据率，是指数据的**传输速率**，表示单位时间内传输的数据量。可以用**码元传输速率**和**信息传输速率**表示。
1. 码元传输速率：别名码元速率、波形速率、调制速率、符号速率等，它表示单位时间内数字通信系统所传输的码元个数(也可以称为**脉冲个数或信号变化的次数**)，单位是**波特**。1波特表示数字通信系统每秒传输一个码元。这里的码元可以是多进制的，也可以是二进制的，但码元速率与进制数无关。
2. 信息传输速率：别名信息速率、比特率等，表示单位时间内数字通信系统传输的二进制码元个数(即比特数)，单位是比特/秒(b/s)。
   * 关系：若一个码元携带n bit的信息量，则M Baud的码元传输速率所对应的信息传输速率为M X b bit/s。
  
带宽：表示在单位时间内从网络中的某一点到另一点所能通过的“**最高数据率**”，常用来表示网络的通信线路所能传输数据的能力。单位是b/s。

### 4. 奈氏准则和香农定理

在这两个定理中带宽用Hz。

#### 失真

现实中的信道因为带宽受限、有噪声、干扰让信号波形走形

有的失真仍能被识别，但有的失真无法被识别

影响失真程度的因素： 
1.  码元传输速率
   *  传输越快，失真程度越严重
2.  信号传输距离
3.  噪声干扰
4.  传输媒体质量

#### 失真的一种现象——码间串扰

**信道带宽**是信道能通过的**最高频率和最低频率之差**。

低带宽会和噪音融合，无法识别，高带宽会造成码间串扰。

码间串扰：**接收端**收到的信号波形**失去了码元之间清晰界限**的现象。

#### 奈氏准侧(奈奎斯特定理)

奈氏准则：在理想低通(无噪声，带宽受限)条件下，为了避免码间串扰，极限码元传输速率为2W Baud，W是信道带宽，单位是Hz。

理想低通信道下`极限数据传输率=2Wlog2 V(b/s)`，其中`W`是`带宽(HZ)`,`V`是`几种码元/码元的离散电平数目`。

1. 在任何信道中，**码元传输的速率是有上线的**。若传输速率超过此上线，就会出现严重的码间串扰问题，使接收端对码元的完全正确识别成为不可能。
2. 信道的**频带越宽**(即能通过的信号高频分量越多)，就可以用更高的速率进行码元的有效传输。
3. 奈氏准则给出了码元传输速率的限制，但并没有对信息传输速率给出了限制。
4. 由于码元的传输速率受奈氏准则的制约，所以要提高数据传输速率，就必须设法使每个码元能携带更多个比特的信息量，这就需要采用多元制的调制方法。

#### 香农定理

**噪声**存在于所有的电子设备和通信信道中。由于噪声随机产生，它的瞬间值有时会很大，因此噪声会使接收端对码元的判决产生错误。但是噪声的音响是相对的，若信号较强，那么噪声影响相对较小。因此，**信噪比**就很重要。

`信噪比 = 信号的平均功率/噪声的平均功率`，常记为S/N，应用分贝(dB)作为度量单位，即：`信噪比(dB) = 10log10 (S/N)` *数值等价*

香农定理：在带宽受限且有噪声的信道中，为了不产生误差，信息的数据传输速率有上限值。

`信道的极限数据传输速率 = Wlog2 (1+S/N) (b/s)`

1. 信道的**带宽**或信道中的**信噪比**越大，则信息的极限传输速率就**越高**。
2. 对一定的传输带宽和一定的信噪比，信息传输速率的上限就确定了。
3. 只要信息的传输速率低于信道的极限传输速率，就一定能找到某种方法来实现**无差错的传输**。
4. 香农定理得出的为极限信息传输速率，实际信道能达到的传输速率要比它低不少。
5. 从香农定理可以看出，若信道带宽W或信噪比S/N没有上限(不可能)，那么新到的极限信息传输速率也就没有上限。

#### 奈氏和香农如何选择

* 奈氏准则
  * 内忧
  * 带宽受限无噪声条件下，为了避免码间串扰，码元传输速率的上限`2W`波特。
  * 理想低通信道下`极限数据传输率 = 2Wlog2 V`
  * 想要提高数据率，就要提高带宽/采用更好的编码技术
* 香农定理
  * 外患
  * 带宽受限有噪声条件下的信息传输速率。
  * `信道的极限数据传输速率 = Wlog2 (1+S/N)`
  * 要想提高数据率，就要提高带宽/信噪比

### 5. 编码&调制

#### 基带信号与宽带信号

信道：信号的传输媒介。一般用来表示向某一个方向传送信息的介质，因此一条通信线路往往包含一条发送信道和一条接收信道。

* 传输信号
  * 模拟信道(传送模拟信号)
  * 数字信道(传送数字信号)
* 介质传输
  * 无线信道
  * 有限信道

信道上传送的信号：
* 基带信号
  * 将数字信号1和0直接用两种不用的电压表示，再传送到**数字信道**上去传输(基带传输)。**来自信源**的信号，想计算机输出的代表各种文字或图像文件的数据信号都属于基带信号。基带信号就是发出的**直接表达了要传输的信息的信号**，比如我们说话的声波就是基带信号。
* 宽带信号
  * 将基带信号进行调制后形成的频分复用模拟信号，再传送到**模拟信道**上去传输(宽带传输)。把基带信号经过**载波调制**后，吧信号的**频率范围搬移**到**较高的频段**以便在信道中传输(即仅在一段频率范围内能够通过信道)。

* 在传输距离较近时，计算机网络采用**基带传输**方式(近距离衰减小，从而信号内容不易发生变化)
* 在传输距离较远时，计算机网络采用**宽带传输**方式(远距离衰减大，即使信号变化大也能最后过滤出来基带信号)

#### 编码与调制

* 数据**编码**为数字信号
* 数据**调制**为模拟信号

* 数字数据
  * 通过**数字发送器**转换为数字信号 *编码*
  * 通过**调制器**转换为模拟信号 *调制*
* 模拟数据
  * 通过**PCM编码器**转换为数字信号  *编码*
  * 通过**放大器调制器**转换为模拟信号 *调制*

#### 数字数据编码为数字信号

1. 非归零编码(NRZ)
   * 高1低0
   * 编码容易实现，但没有检错功能，且无法判断一个码元的开始和结束，以至于收发双方**难以保持同步**。
2. 曼彻斯特编码
   * 将一个码元分成两个相等的间隔，前一个间隔为低电平后一个间隔为高电平表示码元1；码元0则账号相反。也可以采用相反的规定。该编码的特点是在每一个马院的中间出现电平跳变，位中间的跳变既作时钟信号(可用于同步)，又作数据信号，但它所占的频带宽度是原始基带宽度的两倍。
   * 每一个码元都被调成两个电平，所以**数据传输速率只有调制速率的二分之一**。
3. 差分曼彻斯特编码
   * 同1异0
   * 常用于局域网传输，其规则是：若码元为1，则前半个码元的电平与上一个码元的后半个码元的电平相同，若为0，则相反。该编码的特点是。在每个码元的中间，都有一次电平的跳转，可以实现自同步，且抗干扰性强于曼彻斯特编码。
4. 归零编码(RZ)
   * 信号电平在一个码元之内都要恢复到零的这种编码成编码方式。
5. 反向不归零编码(NRZI)
   * 信号电平翻转表示0，信号电平不变表示1。
6. 4B/5B编码
   * 比特流中插入额外的比特以打破一连串的0或1，就是用5个比特来编码4个比特的数据，之后再传给接收方，因此称为4B/5B。编码效率为80%。
   * 只采用16种对应16种不同的4位码，其他的16种作为控制码(帧的开始和结束，线路的状态信息等)或保留。

#### 数字信号调制为模拟信号

数字数据调制技术在发送端将数字信号转换为模拟信号，而在接收端将模拟信号还原为数字信号，分别对应于调制解调器的调制过程和解调过程。

* 2ASK调幅
  * 0无波1有波。
* 2FSK调频
  * 0低频1高频。
* 2PSK调相
  * 0余弦1正弦。
* QAM正交振幅调制(调幅+调相)

#### 模拟数据编码为数字信号

计算机内部处理的是二进制数据，处理的都是**数字音频**，所以需要将模拟音频通过采样、量化转换成有限个数字表示的离散序列(即实现**音频数字化**)。

最典型的例子就是对音频信号进行编码的脉码调制(**PCM**)，在计算机应用中，能够达到**最高保真水平**的就是PCM编码，被广泛用于素材保存及音乐欣赏，CD\DVD以及我们常见的WAV文件中均有应用。他主要包括三步：抽样、量化、编码。

1. 抽样：对模拟信号周期性扫描，把时间上连续的信号变成时间上离散的信号。为了使所得的离散信号能无失真地代表被抽样的模拟数据，要使用采样定理进行采样：`f采样频率 = 2f信号最高频率`
2. 量化：把抽样取得的电平幅值按照一定的分级标度转化为对应的数字值，并取整数，这就把连续的电平幅值转换为离散的数字量。
3. 编码：把量化的结果转换为与之对应的二进制编码。

#### 模拟数据调制为模拟信号

为了实现传输的有效性，可能需要较高的频率。这种调制方式还可以使用频分复用技术，充分利用带宽资源。在电话机和本地交换机所传输的信号是采用模拟信号传输模拟数据的方式；模拟的声音数据是加载到模拟的载波信号中传输的。

## 2.2 物理层传输介质

### 传输介质及分类

传输介质也称传输媒体/传输媒介，它就是数据传输系统中在发送设备和接收设备之间的**物理通路**。

传输媒体并不是物理层

传输媒体在物理层的下面，因为物理层是体系结构的第一层，因此有时称传输媒体为0层。在传输媒体中传输的是信号，但传输媒体并不知道所传输的信号代表什么意思。但物理层规定了**电气特性**，因此能够识别所传送的比特流。

* 传输介质
  * 导向性传输介质：电磁波被导向沿着固体媒体(铜线/光纤)传播。
  * 非导向性传播介质：自由空间，介质可以是空气、真空、海水等。

### 导向性传输介质——双绞线

双绞线是古老、又最常用的传输介质，它用**两根**采用一定规则并排**绞合**的、相互绝缘的**铜导线**组成。

**绞合可以减少对相邻导线的电磁干扰。**

* 无屏蔽双绞线
* 屏蔽双绞线

为了进一步提高抗电磁干扰能力，可在双绞线的外面再加上一个由**金属丝**编织成的屏蔽层，这就是**屏蔽双绞线(STP)**，无屏蔽层的双绞线就称为**非屏蔽双绞线(UTP)**。

双绞线夹克便宜，在局域网和传统电话网中普遍使用。模拟传输和数字传输都可以使用双绞线，去通信距离一般为几公里到数十公里。距离太原市，对于**模拟信号**，要用**放大器**放大衰减的信号；对于**数字信号**，要用**中继器**将失真的信号整形。

### 导向性传输介质——同轴电缆

同轴电缆由**导体铜制芯线**、**绝缘层**、**网状编织屏蔽层**和**塑料外层**组成。按特性阻抗数值不同，通常将同轴电缆分为两类：50欧同轴电缆和75欧同轴电缆。其中，50欧同轴电缆主要用于传送基带数字信号，又称为**基带同轴电缆**，它在局域网中得到广泛应用；75欧同轴电缆主要用于传送宽带信号，又称为**宽带同轴电缆**，它主要用于有线电视系统。

### 导向性传输介质——光纤

光纤主要由**纤芯(实心)**和**包层**构成，光波通过纤芯进行传导，包层较纤芯有较低的折射率。当光线从高折射率的介质射向低折射率的介质时，其折射角度将大于入射角。因此，如果入射角足够大，就会出现**全反射**，即光线碰到包层时就会折射回纤芯，这个过程不断重复，光也就沿着光纤传输下去。

* 多模光纤
  * 易失真，适合近距离传输
* 单模光纤
  * 损耗小，适合远距离传输

光纤易折，一般将数十数百跟光纤捆至一起，形成**光缆**。

光纤的特点：
1. 传输损耗小，中继距离长，对远距离传输特别经济。
2. 抗雷电和电磁干扰性能好。
3. 无串音干扰，保密性好，也不容易被窃听或截取数据。
4. 体积小，重量轻。

### 非导向性传输介质

* 无线电波
  * 较强穿透能力，可远距离传输，广泛用于通信领域(如手机通信)
  * 信号向**所有方向**传播
* 微波
  * 微波通信频率较高，频段范围宽，因此数据率很高
    * 地面微波接力通信
    * 卫星通信
      * 优点
        1.  通信容量大
        2.  距离远
        3.  覆盖广
        4.  广播通信和多址通信
       *  缺点
        1. 传播时延长(250-270ms)
        2. 受气候影响大(eg:强风太阳黑子爆发、日凌)
        3. 误码率较高
        4. 成本高
   * 信号**固定方向**传播
* 红外线、激光
  * 把药传输的信号分别**转换为各自的信号格式**，即红外光信号和激光信号，再在空间中传播。
  * 信号**固定方向**传播

## 2.3 物理层设备

### 中继器

诞生原因：由于存在损耗，在线路上传输的信号功率会逐渐衰减，衰减到一定程度时将造成信号失真，因此会导致接收错误。

中继器的功能：对信号进行**再生和还原**，对衰减的信号进行放大，保持与原数据相同，以增加信号传输的距离，延长网络的长度。

中继器的两端：
* 两端的网络部分是网段，而不是子网，适用于完全相同的**两类**网络的互连，且两个网段速率要相同。
* 中继器只将任何电缆段上的数据发送到另一段电缆上，它仅作用于信号的电气部分，并不管数据中是否有错误数据或不适于网段的数据。
* 两端可连相同媒体，也可连不同媒体。
* 中继器两端的网段一定要是同一个协议。(中继器不会存储转发)

5-4-3规则：
* 网络标准中对信号的延迟范围做了具体的规定，因而中继器只能在规定的范围内进行，否则会网络故障。
* 5：最多涉及5个网段
* 4：最多经过4个中继器
* 3：最多3个段可以挂工作站

### 集线器(多口中继器)

再生，放大信号

集线器的功能：对信号进行**再生放大转发**，对衰减的信号进行放大，接着转发到其他所有处于工作状态的端口上，以增加信号传输的距离，延长网络的长度。不具备信号的定向传送能力，是一个共享式设备。

遇到同时两个端口发生碰撞的现象则随机延时后再次通信。

集线器不能分隔冲突域，所以连在集线器上的工作主机平分带宽。

# 第3章——数据链路层

## 3.1 数据链路层功能概述

1. 链路层的功能
2. 链路层的两种信道
3. 局域网、广域网
4. 链路层的设备

### 数据链路层基本概述

* 结点：主机、路由器
* 链路：网络中两个结点之间的**物理通道**，链路的传输介质主要有双绞线、光纤和微波。分为有线链路、无线链路。
* 数据链路：网络中两个结点之间的**逻辑通道**，把实现控制数据传输**协议**的硬件和软件加到链路上就构成数据链路。
* 帧：链路层的协议数据单元，封装网络层数据报。

数据链路层负责通过一条链路从一个结点向另一个物理链路直接相连的相邻结点传送数据报。

数据链路层在物理层提供服务的基础上**向网络层提供服务**，其最基本的服务是将源自网络层来的数据**可靠**地传输到相邻结点的目标机网络层。其主要作用是**加强网络层传输原始比特流的功能**，将物理层提供的可能出错的物理连接改造成为**逻辑上无差错的数据链路**，使之对网络层表现为一条无差错的链路。

功能：
1. 为网络层提供服务：
   * 无确认无连接服务
   * 有确认无连接服务
   * 有确认面向连接服务
2. 链路管理：
   * 建立
   * 维持
   * 释放
3. 组帧
4. 流量控制
5. 差错控制(帧错/位错)

## 3.2 封装成帧和透明传输

由于字节计算法中`Count`字段的脆弱性(其值若有差错将导致灾难性后果)及字符填充实现上的复杂性和不兼容性，目前普遍使用的帧同步法是**比特填充**和**违规编码法**。

### 封装成帧

**封装成帧**就是在一段数据的前后部分添加首部和尾部，这样就构成了一个帧。接收端在收到物理层上交的比特流后，就能根据首部和尾部的标记，从收到的比特流中识别帧的开始和结束。

首部和尾部包含许多的控制信息，他们的一个重要作用：**帧定界**(确定帧的界限)。

帧同步：**接收方**应当能从接收到的二进制比特流中区分出帧的起始和终止。

组帧的四种方法：
1. 字符计算法
2. 字符填充法
3. 零比特填充法
4. 违规编码法

### 透明传输

**透明传输**是指不管所传数据是什么样的比特组合，都应当能够在链路上传送。因此，链路层就“看不见”有什么妨碍数据传输的东西。

当所传输数据中的比特组合恰巧与某一个控制信息完全一样时，就必须才去适当的措施，使收方不会将这样的数据误认为是某种控制信息。这样才能保证数据链路层的传输是透明的。

### 1. 字符计算法

帧首部使用一个计数字段(第一个**字节**，八位)来表明帧内字符数。

缺点：第一个字符错，整个就错了。

### 2. 字符填充法

`00000001`是开始字节，`00000100`是结束字节

当传送的帧时由文本文件组成时(文本文件的字符都是从键盘上输入的，都是ASCII码)。不管从键盘上输入什么字符都可以放在帧里传过去，即**透明传输**。

当传送的帧时由非ASCII码的文本文件组成时(二进制代码的程序或图像等)。就要**采用字符填充方法实现透明传输**。

使用`转义字符ESC`在与控制字符`SOT、EOT`相同的数据转义，就不会造成冲突。

### 3. 零比特填充法

1. 在头尾插入`01111110`
2. 在发送端，扫描整个信息字段，只要连续5个1，就立即填入1个0
3. 在接收端收到一个帧时，先找到标志字段确定边界，再用硬件对比特流进行扫描。发现连续5个1时，就把后面的0删除。

**保证了透明传输：在传送的比特流中可以传送任意比特组合，而不会引起对帧边界的判断错误。**

### 4. 违规编码

用不符合规则的编码来界定帧

如：曼彻斯特编码使用“高-高”、“低-低”的编码充当开始和结束。

## 3.3 差错控制

### 3.3.1 检错编码

#### 差错从何而来？

概括来说，传输中的差错都是由于噪声引起的。

* 全局性：
  * 由于线路本身的电气特性所产生的**随机噪声(热噪声)**，是信道固有的，随机存在的。
  * 解决办法：提高信噪比来减少或避免干扰(对传感器下手)。
* 局部性：
  * 外界特定的端在原因造成的**冲击噪声**，是产生差错的主要原因。
  * 解决办法：通常利用编码技术来解决。

* 差错
  * 位错
    * 比特位出错，1变0，,变1.
  * 帧错
    * 丢失
    * 重复
    * 失序

* 差错控制(比特错)
  * 检错编码
    * 奇偶校验码
    * 循环冗余码CRC
  * 纠错编码
    * 海明码

编码VS编码：物理链路层编码和物理层的数据编码与调制**不同**物理层编码针对的是**单个比特**，解决传输过程中比特的同步问题，如曼彻斯特编码，而数据链路层的编码针对的是**一组比特**，它通过冗余码的技术实现一组二进制比特串在传输过程是否出现差错。

冗余编码：在数据发送之前，先按某种关系**附加**上一定的**冗余位**，构成一个符合某一规则的码字后再发送。当然发送的有效数据变化时，相应的冗余位也随之变化，使码字遵从不变的规则。接收端根据收到码字是否仍符合原则，从而判断是否出错。

#### 奇偶校验码

* 奇偶校验码
  * 奇校验码
    * “1”的个数为**奇数**。
    * 只能检查出**奇数个比特错误**，检错能力为50%。
  * 偶校验码
    * “1”的个数为**偶数**。

#### CRC循环冗余码

我操这个数学运算的过程我没法记呀，看到这里就百度吧！

在数据链路层仅仅使用循环冗余检验CRC差错检测奇数，只能做到对帧的无差错接收，即“凡是接收端数据链路层接受的帧，我们都以非常接近于1的概率认为这些帧再传输过程中没有产生差错”。接收端丢弃的帧虽然曾收到了，但是最终还是因为有差错被丢弃。“凡是接收端数据链路层接收的帧均无差错”。

链路层使用CRC检验，能够实现无比特差错的传输，但这还不是可靠传输，因为有帧被丢弃了。

# 第4章——网络层

# 第5章——传输层

# 第6章——应用层


# Read Me！

>Writed by gddFeng,  
Can't share without permission!